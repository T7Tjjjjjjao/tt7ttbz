<script>
    // Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
    const DISCORD_WEBHOOK = "https://canary.discord.com/api/webhooks/1457279958027341834/yVx8Z2TPHH8GvgWHSWilmNWHhWhS-gJIFeBJQ0aYUchkEPfFnQPlYsORIzRcHEnvug58";

    function generate() {
        const rawInput = document.getElementById('rawUrl').value.trim();
        const resInput = document.getElementById('resUrl');
        
        if (rawInput !== "") {
            // Ù†Ø£Ø®Ø° Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆÙ†Ø­Ø°Ù Ø£ÙŠ "Parameters" Ù‚Ø¯ÙŠÙ…Ø©
            let currentUrl = window.location.origin + window.location.pathname;
            
            // ØªØ´ÙÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ø§Ù„Ù€ loadstring
            try {
                let encoded = btoa(rawInput);
                resInput.value = currentUrl + "?s=" + encoded;
            } catch (e) {
                resInput.value = "Error: Invalid Link Format";
            }
        } else {
            resInput.value = "";
        }
    }

    async function copyAndNotify() {
        const res = document.getElementById('resUrl');
        const rawValue = document.getElementById('rawUrl').value;
        
        if (!res.value || res.value.includes("Error")) {
            alert("Please enter a valid link first!");
            return;
        }

        // Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù†Ø³Ø®
        res.select();
        res.setSelectionRange(0, 99999); // Ù„Ù„Ù‡ÙˆØ§ØªÙ
        document.execCommand('copy');
        alert("Link Copied to Clipboard! ğŸš€");

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
        if (DISCORD_WEBHOOK) {
            await fetch(DISCORD_WEBHOOK, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    embeds: [{
                        title: "ğŸ”— New Link Shortened!",
                        color: 53191,
                        fields: [
                            { name: "ğŸ‘¤ User", value: "T 7 T Client", inline: true },
                            { name: "ğŸ“œ Script", value: "```" + rawValue + "```" },
                            { name: "ğŸš€ Generated Link", value: "```" + res.value + "```" }
                        ],
                        footer: { text: "T 7 T System â€¢ " + new Date().toLocaleString() }
                    }]
                })
            });
        }
    }

    // Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø®ØªØµØ±
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        const scriptBase64 = urlParams.get('s');
        
        if (scriptBase64) {
            try {
                const originalUrl = atob(scriptBase64);
                window.location.href = originalUrl;
            } catch (e) {
                console.error("Link translation error");
            }
        }
    };
</script>
