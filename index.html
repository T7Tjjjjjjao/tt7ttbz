<script>
    const DISCORD_WEBHOOK = "https://canary.discord.com/api/webhooks/1457279958027341834/yVx8Z2TPHH8GvgWHSWilmNWHhWhS-gJIFeBJQ0aYUchkEPfFnQPlYsORIzRcHEnvug58";

    function generate() {
        const rawInput = document.getElementById('rawUrl').value.trim();
        const resInput = document.getElementById('resUrl');
        
        if (rawInput !== "") {
            let currentUrl = window.location.origin + window.location.pathname;
            try {
                // ØªØ´ÙÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·
                let encoded = btoa(rawInput);
                let shortLink = currentUrl + "?s=" + encoded;
                
                // ØªØ¬Ù‡ÙŠØ² Ø£Ù…Ø± Ø§Ù„Ù€ Loadstring ÙƒØ§Ù…Ù„Ø§Ù‹ ÙƒÙ…Ø§ Ø·Ù„Ø¨ØªÙ‡
                resInput.value = 'loadstring(game:HttpGet("' + shortLink + '", true))()';
            } catch (e) {
                resInput.value = "Error: Invalid Link Format";
            }
        } else {
            resInput.value = "";
        }
    }

    async function copyAndNotify() {
        const res = document.getElementById('resUrl');
        const rawValue = document.getElementById('rawUrl').value;
        
        if (!res.value) return;

        res.select();
        document.execCommand('copy');
        alert("Full Script Copied! Paste it into your executor ğŸš€");

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
        await fetch(DISCORD_WEBHOOK, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                embeds: [{
                    title: "ğŸ”¥ New Script Copied!",
                    color: 53191,
                    fields: [
                        { name: "ğŸ“œ Original Raw", value: "```" + rawValue + "```" },
                        { name: "ğŸ”— Full Loadstring", value: "```lua\n" + res.value + "\n```" }
                    ],
                    footer: { text: "T 7 T System â€¢ " + new Date().toLocaleString() }
                }]
            })
        });
    }

    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        const scriptBase64 = urlParams.get('s');
        if (scriptBase64) {
            window.location.href = atob(scriptBase64);
        }
    };
</script>
